{\rtf1\ansi\ansicpg1251\cocoartf1561\cocoasubrtf600
{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fswiss\fcharset0 ArialMT;}
{\colortbl;\red255\green255\blue255;\red34\green34\blue34;}
{\*\expandedcolortbl;;\csgenericrgb\c13333\c13333\c13333;}
{\info
{\author \'c5\'ea\'e0\'f2\'e5\'f0\'e8\'ed\'e0 \'ca\'ee\'e2\'e0\'eb\'e5\'e2\'e0}}\paperw11900\paperh16840\margl1440\margr1440\vieww12200\viewh14580\viewkind1\viewscale125
\deftab720
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f0\fs20 \cf2 \uc0\u1058 \u1077 \u1089 \u1090 \u1086 \u1074 \u1086 \u1077  \u1079 \u1072 \u1076 \u1072 \u1085 \u1080 \u1077 :\
\
I. \uc0\u1047 \u1072 \u1076 \u1072 \u1095 \u1091  \u1087 \u1088 \u1086 \u1089 \u1100 \u1073 \u1072  \u1074 \u1099 \u1087 \u1086 \u1083 \u1085 \u1080 \u1090 \u1100  \u1074  \u1090 \u1077 \u1082 \u1089 \u1090 \u1086 \u1074 \u1086 \u1081  \u1092 \u1086 \u1088 \u1084 \u1077  (\u1085 \u1077  \u1085 \u1091 \u1078 \u1085 \u1086  \u1076 \u1077 \u1083 \u1072 \u1090 \u1100  \u1082 \u1072 \u1088 \u1090 \u1080 \u1085 \u1082 \u1080 , \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1099  xls \u1080  \u1090 .\u1076 .):\
\
1) \uc0\u1055 \u1086 \u1089 \u1090 \u1088 \u1086 \u1080 \u1090 \u1100  \u1073 \u1072 \u1079 \u1091  \u1048 \u1085 \u1090 \u1077 \u1088 \u1085 \u1077 \u1090 -\u1084 \u1072 \u1075 \u1072 \u1079 \u1080 \u1085 \u1072 : \u1074 \u1099 \u1089 \u1083 \u1072 \u1090 \u1100  \u1089 \u1090 \u1088 \u1091 \u1082 \u1090 \u1091 \u1088 \u1091  \u1080  \u1089 \u1086 \u1089 \u1090 \u1072 \u1074  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094  (\u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1072  \u1050 \u1083 \u1080 \u1077 \u1085 \u1090 \u1099 : \u1087 \u1086 \u1083 \u1077  A, \u1087 \u1086 \u1083 \u1077  \u1041  \u1080  \u1090 .\u1076 .) \u1055 \u1077 \u1088 \u1077 \u1076  \u1085 \u1072 \u1095 \u1072 \u1083 \u1086 \u1084  \u1087 \u1088 \u1086 \u1077 \u1082 \u1090 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1103  \u1073 \u1072 \u1079 \u1099 , \u1085 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1086  \u1087 \u1088 \u1086 \u1095 \u1080 \u1090 \u1072 \u1090 \u1100  \u1074 \u1089 \u1077  \u1079 \u1072 \u1076 \u1072 \u1095 \u1080 , \u1090 \u1072 \u1082  \u1082 \u1072 \u1082  \u1077 \u1089 \u1090 \u1100  \u1087 \u1086 \u1083 \u1103 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1085 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1086  \u1073 \u1091 \u1076 \u1077 \u1090  \u1086 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1100  \u1074  \u1089 \u1090 \u1088 \u1091 \u1082 \u1090 \u1091 \u1088 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 .\
\
2) \uc0\u1053 \u1072 \u1087 \u1080 \u1089 \u1072 \u1090 \u1100  \u1079 \u1072 \u1087 \u1088 \u1086 \u1089 \u1099 :\
\uc0\u1047 \u1072 \u1076 \u1072 \u1095 \u1072  1\
\uc0\u1062 \u1077 \u1083 \u1100 : \u1089 \u1087 \u1080 \u1089 \u1086 \u1082  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074  (\u1060 \u1048 \u1054 )\
\uc0\u1059 \u1089 \u1083 \u1086 \u1074 \u1080 \u1077 : \u1089 \u1086 \u1074 \u1077 \u1088 \u1096 \u1072 \u1083 \u1080  \u1079 \u1072 \u1082 \u1072 \u1079 \u1099  \u1074  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076  \u1089  01.01.18 \u1087 \u1086  02.01.18\
\uc0\u1042  \u1079 \u1072 \u1082 \u1072 \u1079 \u1072 \u1093  \u1073 \u1099 \u1083  \u1090 \u1086 \u1074 \u1072 \u1088  X, \u1087 \u1088 \u1086 \u1080 \u1079 \u1074 \u1086 \u1076 \u1080 \u1090 \u1077 \u1083 \u1103  Y\
\
\uc0\u1047 \u1072 \u1076 \u1072 \u1095 \u1072  2\
\uc0\u1062 \u1077 \u1083 \u1100 : \u1089 \u1087 \u1080 \u1089 \u1086 \u1082  \u1079 \u1072 \u1082 \u1072 \u1079 \u1086 \u1074  \u1086 \u1090  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074  \u1089  \u1080 \u1084 \u1077 \u1085 \u1077 \u1084  \u1048 \u1074 \u1072 \u1085 \
\uc0\u1059 \u1089 \u1083 \u1086 \u1074 \u1080 \u1077 : \u1089 \u1086 \u1074 \u1077 \u1088 \u1096 \u1072 \u1083 \u1080  \u1079 \u1072 \u1082 \u1072 \u1079 \u1099  \u1074  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076  \u1089  01.01.18 \u1087 \u1086  02.01.18\
\uc0\u1057 \u1091 \u1084 \u1084 \u1072  \u1079 \u1072 \u1082 \u1072 \u1079 \u1086 \u1074  \u1086 \u1090  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074  \u1079 \u1072  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1080 \u1083 \u1080  \u1088 \u1072 \u1074 \u1085 \u1086  10\u1090 \u1099 \u1089 .\u1088 .\
\uc0\u1042  \u1079 \u1072 \u1082 \u1072 \u1079 \u1072 \u1093  \u1085 \u1077  \u1073 \u1099 \u1083 \u1086  \u1090 \u1086 \u1074 \u1072 \u1088 \u1072  X, \u1085 \u1086  \u1073 \u1099 \u1083  \u1090 \u1086 \u1074 \u1072 \u1088  Y\
\
\uc0\u1047 \u1072 \u1076 \u1072 \u1095 \u1072  3\
\uc0\u1062 \u1077 \u1083 \u1100 : \u1089 \u1087 \u1080 \u1089 \u1086 \u1082  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074 , \u1085 \u1077  \u1089 \u1086 \u1074 \u1077 \u1088 \u1096 \u1072 \u1102 \u1097 \u1080 \u1093  \u1087 \u1086 \u1082 \u1091 \u1087 \u1082 \u1080  \u1085 \u1072  \u1087 \u1088 \u1086 \u1090 \u1103 \u1078 \u1077 \u1085 \u1080 \u1080  6 \u1084 \u1077 \u1089 \u1103 \u1094 \u1077 \u1074 .\
\uc0\u1059 \u1089 \u1083 \u1086 \u1074 \u1080 \u1103 : \u1050 \u1083 \u1080 \u1077 \u1085 \u1090 \u1099 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1073 \u1099 \u1083 \u1080  \u1089  \u1086 \u1073 \u1086 \u1088 \u1086 \u1090 \u1086 \u1084  \u1074 \u1099 \u1096 \u1077  \u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1075 \u1086  \u1074  \u1072 \u1085 \u1072 \u1083 \u1086 \u1075 \u1080 \u1095 \u1085 \u1086 \u1084  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076 \u1077  \u1087 \u1088 \u1086 \u1096 \u1083 \u1086 \u1075 \u1086  \u1075 \u1086 \u1076 \u1072 . \u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1099  \u1080 \u1079  \u1090 \u1086 \u1087 -3 \u1088 \u1077 \u1075 \u1080 \u1086 \u1085 \u1086 \u1074  \u1087 \u1086  \u1087 \u1088 \u1086 \u1076 \u1072 \u1078 \u1072 \u1084 .\
\
\uc0\u1047 \u1072 \u1076 \u1072 \u1095 \u1072  4\
\uc0\u1062 \u1077 \u1083 \u1100 : \u1089 \u1087 \u1080 \u1089 \u1086 \u1082  \u1079 \u1072 \u1082 \u1072 \u1079 \u1086 \u1074  \u1089  \u1091 \u1089 \u1083 \u1086 \u1074 \u1085 \u1086  \u1087 \u1088 \u1086 \u1073 \u1083 \u1077 \u1084 \u1085 \u1099 \u1084 \u1080  \u1076 \u1086 \u1089 \u1090 \u1072 \u1074 \u1082 \u1072 \u1084 \u1080 .\
\uc0\u1059 \u1089 \u1083 \u1086 \u1074 \u1080 \u1077 : \u1044 \u1086 \u1089 \u1090 \u1072 \u1074 \u1082 \u1072  \u1073 \u1099 \u1083 \u1072  \u1089 \u1076 \u1077 \u1083 \u1072 \u1085 \u1072  \u1085 \u1072  \u1101 \u1090 \u1086 \u1081  \u1085 \u1077 \u1076 \u1077 \u1083 \u1077  \u1074 \u1086 \u1076 \u1080 \u1090 \u1077 \u1083 \u1103 \u1084 \u1080  \u1089  \u1087 \u1083 \u1086 \u1093 \u1080 \u1084 \u1080  \u1086 \u1090 \u1082 \u1083 \u1080 \u1082 \u1072 \u1084 \u1080  \u1079 \u1072  \u1090 \u1077 \u1082 \u1091 \u1097 \u1080 \u1081  \u1084 \u1077 \u1089 \u1103 \u1094  \u1086 \u1090  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074 . \u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1099  - \u1074 \u1099 \u1089 \u1086 \u1082 \u1086 \u1076 \u1086 \u1093 \u1086 \u1076 \u1085 \u1099 \u1077  \u1079 \u1072  \u1074 \u1089 \u1077  \u1074 \u1088 \u1077 \u1084 \u1103  \u1088 \u1072 \u1073 \u1086 \u1090 \u1099 .\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\fs22 \cf0 \
\
\uc0\u1056 \u1077 \u1096 \u1077 \u1085 \u1080 \u1077 \
\
# \uc0\u1057 \u1086 \u1079 \u1076 \u1072 \u1085 \u1080 \u1077  \u1073 \u1072 \u1079 \u1099  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 \
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f1 \cf0 CREATE DATABASE `tasks`;\
USE `tasks`;\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f0 \cf0 # \uc0\u1057 \u1086 \u1079 \u1076 \u1072 \u1085 \u1080 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 , \u1080 \u1079  \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1093  \u1089 \u1086 \u1089 \u1090 \u1086 \u1080 \u1090  \u1073 \u1072 \u1079 \u1072  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 \
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f1 \cf0 CREATE TABLE `clients` (\
client_id INT AUTO_INCREMENT NOT NULL, \
name VARCHAR(45) NOT NULL, \
region VARCHAR(50), \
PRIMARY KEY (client_id) );\
\
CREATE TABLE `drivers` (\
driver_id INT AUTO_INCREMENT NOT NULL, \
name VARCHAR(40),\
PRIMARY KEY (idriver_id));\
\
CREATE TABLE `items`(\
item_id INT AUTO_INCREMENT NOT NULL,\
name VARCHAR(50),\
producer VARCHAR (50),\
price INT NOT NULL,\
PRIMARY KEY (item_id));\
\
CREATE TABLE `orders` (\
order_id INT AUTO_INCREMENT NOT NULL, \
dater DATETIME DEFAULT CURRENT_TIMESTAMP, \
item_num INT,\
client_id INT,\
item_id INT,\
deliv_problem BIT, \
driver_id INT,\
PRIMARY KEY (order_id),\
CONSTRAINT `on_item` FOREIGN KEY (item_id) REFERENCES items(id) ON DELETE CASCADE ON UPDATE CASCADE,\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0
\cf0 CONSTRAINT `on_client` FOREIGN KEY (client_id) REFERENCES clients(id) ON DELETE CASCADE ON UPDATE CASCADE\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0
\cf0 );\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f0 \cf0 # \uc0\u1047 \u1072 \u1087 \u1086 \u1083 \u1085 \u1077 \u1085 \u1080 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094  \u1076 \u1072 \u1085 \u1085 \u1099 \u1084 \u1080 \
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f1 \cf0 INSERT INTO `clients` (name,region) VALUES ('Lupin Adam Victorovich','Moscow'),\
('Bobrov Ivan Nikolaevich','S-Peterburg'),\
('Hohlov Victor Yurievich','LA'),\
('Lilev Winsent Borisovich','New-York'),\
('Krasnov Ivan Ivanovich','Krasnodar'),\
('Nomin Ivan Leonidovich','Mumbai');\
\
INSERT INTO `drivers` (name) VALUES ('Alex'),\
('Sergei'),\
('Nicholas'),\
('Zack'),\
('Denzel');\
\
INSERT INTO `items` (name, producer, price) VALUES\
('X', 'Y', 5000),\
('X','Z', 7000),\
('Y', 'Y', 9000),\
('K', 'Y', 4000);\
\
INSERT INTO `orders` (item_num, client_id, item_id, deliv_problem, driver_id) VALUES\
(3, 2, 3, 0, 6), (1, 4, 2, 1, 1), (8, 1, 1, 1, 3), (2, 2, 1, 1, 1),\
(10, 3, 1, 0, 2), (3, 3, 4, 0, 4), (5, 3, 3, 0, 6), (9, 4, 4, 1, 1),\
(2, 5, 2, 0, 5), (1, 5, 2, 1, 3), (7, 1, 3, 0, 4), (1, 1, 1, 1, 2),\
(3, 2, 4, 1, 5), (6, 4, 2, 1, 5);\
\
UPDATE `orders` SET `dater` = '2018-01-01 22:12:10' WHERE id BETWEEN 1 AND 4;\
UPDATE `orders` SET `dater` = '2020-04-05 02:12:10' WHERE id BETWEEN 5 AND 7;\
UPDATE `orders` SET `dater` = '2018-02-01 20:12:10' WHERE id BETWEEN 8 AND 11;\
UPDATE `orders` SET `dater` = '2021-09-04 08:12:10' WHERE id BETWEEN 12 AND 14;\
\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f0 \cf0 # \uc0\u1047 \u1072 \u1076 \u1072 \u1085 \u1080 \u1077  \u8470 1\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f1 \cf0 SELECT clients.name FROM clients \
INNER JOIN orders ON clients.id = orders.client_id\
INNER JOIN items ON items.id = orders.item_id WHERE items.name = 'X' AND items.producer = 'Y' \
AND orders.dater BETWEEN '2018-01-01' AND '2018-01-02';\
\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f0 \cf0 #\uc0\u1047 \u1072 \u1076 \u1072 \u1085 \u1080 \u1077  \u8470 
\f1 2\
SELECT * FROM orders LEFT JOIN items USING(item_id) LEFT JOIN clients USING(client_id)\
HAVING client_id IN (SELECT client_id FROM orders LEFT JOIN items USING(item_id)\
GROUP BY client_id HAVING SUM(item_num*items.price) > 10000)\
AND clients.name LIKE '%Ivan%' AND client_id IN (\
SELECT client_id FROM orders WHERE orders.dater BETWEEN '2018-01-01' AND '2018-01-02') \
AND client_id IN (SELECT client_id FROM orders LEFT JOIN items USING(item_id) WHERE name = 'Y' AND items.name <> 'X');\
\

\f0 #\uc0\u1047 \u1072 \u1076 \u1072 \u1085 \u1080 \u1077  \u8470 3\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f1 \cf0 SELECT DISTINCT client_id FROM orders WHERE client_id NOT IN (\
SELECT client_id FROM orders WHERE orders.dater BETWEEN '2021-01-01' AND '2021-06-01') AND client_id IN  (\
SELECT client_id FROM orders JOIN items USING(item_id) WHERE orders.dater BETWEEN '2020-01-01' AND\
 '2020-06-06' GROUP BY client_id HAVING SUM(item_num*items.price) > (SELECT SUM(item_num*items.price)/COUNT(client_id) FROM\
 orders JOIN items USING(item_id))) AND client_id IN (SELECT GROUP_CONCAT(client_id) FROM clients JOIN orders USING(client_id)\
JOIN items USING(item_id) GROUP BY region ORDER BY SUM(item_num*items.price) DESC LIMIT 3);\
\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f0 \cf0 # \uc0\u1047 \u1072 \u1076 \u1072 \u1085 \u1080 \u1077  \u8470 4\
\pard\pardeftab720\ri-9\sl276\slmult1\partightenfactor0

\f1 \cf0 SELECT order_id FROM orders JOIN drivers USING(driver_id) WHERE deliv_problem = 1 AND\
 dater BETWEEN NOW() AND SUBDATE(NOW(), INTERVAL 1 WEEK) AND driver_id IN (\
 SELECT driver_id FROM drivers JOIN orders USING (driver_id) WHERE dater BETWEEN NOW() AND\
 SUBDATE(NOW(), INTERVAL 1 MONTH) AND deliv_problem = 1) AND client_id IN (\
 SELECT client_id FROM orders JOIN items USING(item_id) GROUP BY client_id HAVING \
 SUM(item_num*items.price)>(SELECT AVG(item_num*items.price) FROM orders JOIN items USING(item_id)))
\f0 \
}